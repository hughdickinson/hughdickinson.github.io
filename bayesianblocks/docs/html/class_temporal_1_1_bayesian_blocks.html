<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>Bayesian Blocks: Temporal::BayesianBlocks Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Bayesian Blocks
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
   <div id="projectbrief">C++ implementation of the Bayesian Blocks Algorithm</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_temporal.html">Temporal</a></li><li class="navelem"><a class="el" href="class_temporal_1_1_bayesian_blocks.html">BayesianBlocks</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="class_temporal_1_1_bayesian_blocks-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Temporal::BayesianBlocks Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Class finds the optimal partition of an ordered time series based on event rate.  
 <a href="class_temporal_1_1_bayesian_blocks.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_bayesian_blocks_8hh_source.html">BayesianBlocks.hh</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ad7ac522db31a9df81792a18f2cfe717e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_temporal_1_1_bayesian_blocks.html#ad7ac522db31a9df81792a18f2cfe717e">BayesianBlocks</a> (Double_t *eventTimes, Int_t numEvents, Double_t startTime, Double_t endTime, Double_t gamma=-1.0)</td></tr>
<tr class="separator:ad7ac522db31a9df81792a18f2cfe717e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d89490fc677cac5c7a60934904ea916"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_temporal_1_1_bayesian_blocks.html#a2d89490fc677cac5c7a60934904ea916">~BayesianBlocks</a> ()</td></tr>
<tr class="separator:a2d89490fc677cac5c7a60934904ea916"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af557149b5ff578c06e88daecc4630fcd"><td class="memItemLeft" align="right" valign="top">std::vector&lt; Double_t &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_temporal_1_1_bayesian_blocks.html#af557149b5ff578c06e88daecc4630fcd">GetBlocks</a> ()</td></tr>
<tr class="separator:af557149b5ff578c06e88daecc4630fcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a74f50f04bfbdb357ce4480fe938eedb2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_temporal_1_1_bayesian_blocks.html#a74f50f04bfbdb357ce4480fe938eedb2">ConstructCells</a> ()</td></tr>
<tr class="memdesc:a74f50f04bfbdb357ce4480fe938eedb2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method constructs the vector of cell widths.  <a href="#a74f50f04bfbdb357ce4480fe938eedb2">More...</a><br /></td></tr>
<tr class="separator:a74f50f04bfbdb357ce4480fe938eedb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cb297c240989be96626a89b9fd6ec7c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_temporal_1_1_bayesian_blocks.html#a4cb297c240989be96626a89b9fd6ec7c">OptimumPartition</a> ()</td></tr>
<tr class="memdesc:a4cb297c240989be96626a89b9fd6ec7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method which constructs the optimum partition of an interval.  <a href="#a4cb297c240989be96626a89b9fd6ec7c">More...</a><br /></td></tr>
<tr class="separator:a4cb297c240989be96626a89b9fd6ec7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd4086b8c86998b5b7815920e76bb4f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_temporal_1_1_bayesian_blocks.html#acd4086b8c86998b5b7815920e76bb4f8">Reset</a> ()</td></tr>
<tr class="memdesc:acd4086b8c86998b5b7815920e76bb4f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method to reset clear all of the persistent vectors and deques.  <a href="#acd4086b8c86998b5b7815920e76bb4f8">More...</a><br /></td></tr>
<tr class="separator:acd4086b8c86998b5b7815920e76bb4f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e5a4620c8e15fd41ad7c87dd2cc7240"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_temporal_1_1_bayesian_blocks.html#a9e5a4620c8e15fd41ad7c87dd2cc7240">SetNumEvents</a> (Int_t numEvents=0)</td></tr>
<tr class="memdesc:a9e5a4620c8e15fd41ad7c87dd2cc7240"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method to set the number of events in the DataSet.  <a href="#a9e5a4620c8e15fd41ad7c87dd2cc7240">More...</a><br /></td></tr>
<tr class="separator:a9e5a4620c8e15fd41ad7c87dd2cc7240"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadb26f9efc6b79e6397c926fda3dbca5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_temporal_1_1_bayesian_blocks.html#aadb26f9efc6b79e6397c926fda3dbca5">SetEventTimes</a> (Double_t *eventTimes=0)</td></tr>
<tr class="memdesc:aadb26f9efc6b79e6397c926fda3dbca5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method to set the array of event times.  <a href="#aadb26f9efc6b79e6397c926fda3dbca5">More...</a><br /></td></tr>
<tr class="separator:aadb26f9efc6b79e6397c926fda3dbca5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecf27bfb50deb6a919d89d55a04c0dc0"><td class="memItemLeft" align="right" valign="top">std::vector&lt; Double_t &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_temporal_1_1_bayesian_blocks.html#aecf27bfb50deb6a919d89d55a04c0dc0">GetBlockEdges</a> ()</td></tr>
<tr class="memdesc:aecf27bfb50deb6a919d89d55a04c0dc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method to extract the actual times of the changepoints.  <a href="#aecf27bfb50deb6a919d89d55a04c0dc0">More...</a><br /></td></tr>
<tr class="separator:aecf27bfb50deb6a919d89d55a04c0dc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a883de9dc93776d348a50e611ec300eb2"><td class="memItemLeft" align="right" valign="top">Double_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_temporal_1_1_bayesian_blocks.html#a883de9dc93776d348a50e611ec300eb2">CalcFitness</a> (std::vector&lt; Double_t &gt;::iterator &amp;first, std::vector&lt; Double_t &gt;::iterator &amp;last)</td></tr>
<tr class="memdesc:a883de9dc93776d348a50e611ec300eb2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method calculates the fitness of a given interval.  <a href="#a883de9dc93776d348a50e611ec300eb2">More...</a><br /></td></tr>
<tr class="separator:a883de9dc93776d348a50e611ec300eb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a00dfabcba71342784fe1b43c2d5959ac"><td class="memItemLeft" align="right" valign="top">std::vector&lt; Double_t &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_temporal_1_1_bayesian_blocks.html#a00dfabcba71342784fe1b43c2d5959ac">fEventTimes</a></td></tr>
<tr class="memdesc:a00dfabcba71342784fe1b43c2d5959ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">A vector formed from the input array of event times.  <a href="#a00dfabcba71342784fe1b43c2d5959ac">More...</a><br /></td></tr>
<tr class="separator:a00dfabcba71342784fe1b43c2d5959ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7775a6c55a14de1d699a00827f88cc65"><td class="memItemLeft" align="right" valign="top">std::vector&lt; Double_t &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_temporal_1_1_bayesian_blocks.html#a7775a6c55a14de1d699a00827f88cc65">fCellWidths</a></td></tr>
<tr class="memdesc:a7775a6c55a14de1d699a00827f88cc65"><td class="mdescLeft">&#160;</td><td class="mdescRight">A vector of the widths of cells formed around the individual events.  <a href="#a7775a6c55a14de1d699a00827f88cc65">More...</a><br /></td></tr>
<tr class="separator:a7775a6c55a14de1d699a00827f88cc65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a823e53c7e269032c4ac6342f834b0c28"><td class="memItemLeft" align="right" valign="top">std::vector&lt; Int_t &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_temporal_1_1_bayesian_blocks.html#a823e53c7e269032c4ac6342f834b0c28">fLast</a></td></tr>
<tr class="memdesc:a823e53c7e269032c4ac6342f834b0c28"><td class="mdescLeft">&#160;</td><td class="mdescRight">A vector containing the index of the last changepoint for all positions.  <a href="#a823e53c7e269032c4ac6342f834b0c28">More...</a><br /></td></tr>
<tr class="separator:a823e53c7e269032c4ac6342f834b0c28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4303f0cbacbab9131db9485f083a45d0"><td class="memItemLeft" align="right" valign="top">std::vector&lt; Double_t &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_temporal_1_1_bayesian_blocks.html#a4303f0cbacbab9131db9485f083a45d0">fBest</a></td></tr>
<tr class="memdesc:a4303f0cbacbab9131db9485f083a45d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">A vector containing the value of the optimal "Fitness" of the previous interval for all positions.  <a href="#a4303f0cbacbab9131db9485f083a45d0">More...</a><br /></td></tr>
<tr class="separator:a4303f0cbacbab9131db9485f083a45d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa52f4f945f05efd9dd9db6bcb77bffab"><td class="memItemLeft" align="right" valign="top">std::vector&lt; Double_t &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_temporal_1_1_bayesian_blocks.html#aa52f4f945f05efd9dd9db6bcb77bffab">fBlockEdges</a></td></tr>
<tr class="memdesc:aa52f4f945f05efd9dd9db6bcb77bffab"><td class="mdescLeft">&#160;</td><td class="mdescRight">A vector the edges of the blocks of the optimum partition in seconds since J2000.  <a href="#aa52f4f945f05efd9dd9db6bcb77bffab">More...</a><br /></td></tr>
<tr class="separator:aa52f4f945f05efd9dd9db6bcb77bffab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3947b6d02cf8fc3f98cbae59326dba75"><td class="memItemLeft" align="right" valign="top">std::deque&lt; Int_t &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_temporal_1_1_bayesian_blocks.html#a3947b6d02cf8fc3f98cbae59326dba75">fChangePoints</a></td></tr>
<tr class="memdesc:a3947b6d02cf8fc3f98cbae59326dba75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector of the changepoints (in terms of cell number) identified by the Bayesian Blocks algorithm.  <a href="#a3947b6d02cf8fc3f98cbae59326dba75">More...</a><br /></td></tr>
<tr class="separator:a3947b6d02cf8fc3f98cbae59326dba75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cdf3d64615a960a4ee8e8d92e71c62c"><td class="memItemLeft" align="right" valign="top">Int_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_temporal_1_1_bayesian_blocks.html#a6cdf3d64615a960a4ee8e8d92e71c62c">fNumEvents</a></td></tr>
<tr class="memdesc:a6cdf3d64615a960a4ee8e8d92e71c62c"><td class="mdescLeft">&#160;</td><td class="mdescRight">The number of events in the Dataset.  <a href="#a6cdf3d64615a960a4ee8e8d92e71c62c">More...</a><br /></td></tr>
<tr class="separator:a6cdf3d64615a960a4ee8e8d92e71c62c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63d24c37ad58710297109c70bf1c192d"><td class="memItemLeft" align="right" valign="top">Double_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_temporal_1_1_bayesian_blocks.html#a63d24c37ad58710297109c70bf1c192d">fStartTime</a></td></tr>
<tr class="memdesc:a63d24c37ad58710297109c70bf1c192d"><td class="mdescLeft">&#160;</td><td class="mdescRight">The start time of the interval in seconds since J2000.  <a href="#a63d24c37ad58710297109c70bf1c192d">More...</a><br /></td></tr>
<tr class="separator:a63d24c37ad58710297109c70bf1c192d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a850f2c3cfe5dbe6845e39fbfb450ddcd"><td class="memItemLeft" align="right" valign="top">Double_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_temporal_1_1_bayesian_blocks.html#a850f2c3cfe5dbe6845e39fbfb450ddcd">fEndTime</a></td></tr>
<tr class="memdesc:a850f2c3cfe5dbe6845e39fbfb450ddcd"><td class="mdescLeft">&#160;</td><td class="mdescRight">The end time of the interval in seconds since J2000.  <a href="#a850f2c3cfe5dbe6845e39fbfb450ddcd">More...</a><br /></td></tr>
<tr class="separator:a850f2c3cfe5dbe6845e39fbfb450ddcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80492db7d18c3c60c846b619561788d0"><td class="memItemLeft" align="right" valign="top">Double_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_temporal_1_1_bayesian_blocks.html#a80492db7d18c3c60c846b619561788d0">fGamma</a></td></tr>
<tr class="memdesc:a80492db7d18c3c60c846b619561788d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">The value of <img class="formulaInl" alt="$\gamma$" src="form_4.png"/> used to penalise the addition of extra blocks.  <a href="#a80492db7d18c3c60c846b619561788d0">More...</a><br /></td></tr>
<tr class="separator:a80492db7d18c3c60c846b619561788d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class finds the optimal partition of an ordered time series based on event rate. </p>
<p>Class finds the optimal partition of an ordered time series based on event rate. The algorithm used is taken from <a href="http://arxiv.org/abs/math/0309285">Jackson et. al (2003)</a>. The class assumes that the event arrival probability is poissonian.</p>
<dl class="section author"><dt>Author</dt><dd>Hugh Dickinson </dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ad7ac522db31a9df81792a18f2cfe717e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Temporal::BayesianBlocks::BayesianBlocks </td>
          <td>(</td>
          <td class="paramtype">Double_t *&#160;</td>
          <td class="paramname"><em>eventTimes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t&#160;</td>
          <td class="paramname"><em>numEvents</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>startTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>endTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>gamma</em> = <code>-1.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a2d89490fc677cac5c7a60934904ea916"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Temporal::BayesianBlocks::~BayesianBlocks </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a883de9dc93776d348a50e611ec300eb2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Double_t Temporal::BayesianBlocks::CalcFitness </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; Double_t &gt;::iterator &amp;&#160;</td>
          <td class="paramname"><em>first</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; Double_t &gt;::iterator &amp;&#160;</td>
          <td class="paramname"><em>last</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Method calculates the fitness of a given interval. </p>
<p>This method calculates the "fitness" of a single block starting at <em>first</em> and ending at <em>last</em> using the following evaluation of the logarithm of the maximum likelihood: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[\log(L_{\max})=N^{k}\log(\frac{N^{k}}{M^{k}})+(M^{k}-N^{k}) \log(1-\frac{N^{k}}{M^{k}}) - \log(\gamma)\]" src="form_0.png"/>
</p>
<p> Where <img class="formulaInl" alt="$M^{k}$" src="form_1.png"/> is the number of events/cells in the block and <img class="formulaInl" alt="$M^{k}$" src="form_1.png"/> is the width of the block in microseconds. The final term <img class="formulaInl" alt="$\log(\gamma)$" src="form_2.png"/> is a term which penalises the addition of extra blocks by reducing the fitness by a constant factor for every block added. The appropriate value of <img class="formulaInl" alt="$gamma$" src="form_3.png"/> should properly be obtained through simulation, however setting <img class="formulaInl" alt="$gamma$" src="form_3.png"/> equal to the number of photons in the DataSet is a good approximation and is the default behaviour of this class.</p>
<p>This fitness function assumes that each cell within the block has either 1 or 0 events in it, which is how we constructed our cells. It also assumes photon arrival time distribution is poissonian. See <a href="http://adsabs.harvard.edu/abs/2008AIPC.1085..775D">U. B. de Almeida et. al. - AIP Conference Proceedings, Volume 1085, pp. 775-778 (2008)</a> for a proof that this is a reasonable assumption for H.E.S.S. eventwise time-tagged data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">first</td><td>- Reference to an iterator over the vector of cellwidths indicating the start cell of the block. </td></tr>
    <tr><td class="paramname">last</td><td>- Reference to an iterator over the vector of cellwidths indicating the end cell of the block. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a74f50f04bfbdb357ce4480fe938eedb2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Temporal::BayesianBlocks::ConstructCells </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Method constructs the vector of cell widths. </p>
<p>This method constructs an array of cell widths defined as the interval between the midpoints of each adjacent pair of events. By definition, the number of events per cell should be equal to 1. <b>Exceptions</b> are the first and last cells in the interval, which extend respectively from the beginning of the interval to the midpoint between the first and second events, and from the midpoint of the second-to-last and last events ro the end of the interval.</p>
<p>The widths are expressed in integer numbers of microseconds (although they must be stored as doubles because of their size). This discretization of the time interval is required for the application of the fitness function. Since the system deadtime is ~ 5 microseconds, this level of resolution ensures that no two cells will ever be coincident. </p>

</div>
</div>
<a class="anchor" id="aecf27bfb50deb6a919d89d55a04c0dc0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; Double_t &gt; * Temporal::BayesianBlocks::GetBlockEdges </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Method to extract the actual times of the changepoints. </p>
<p>This method uses the fChangePoints and fCellWidths vectors to extract the times of any changepoints identified by the method <a class="el" href="class_temporal_1_1_bayesian_blocks.html#a4cb297c240989be96626a89b9fd6ec7c" title="Method which constructs the optimum partition of an interval. ">OptimumPartition()</a>.</p>
<dl class="section return"><dt>Returns</dt><dd>Pointer to a std::vector&lt;Double_t&gt; containing the changepoints in the optimum partition of the interval. </dd></dl>

</div>
</div>
<a class="anchor" id="af557149b5ff578c06e88daecc4630fcd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; Double_t &gt; * Temporal::BayesianBlocks::GetBlocks </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This method returns a std::vector&lt;Double_t&gt; containing the changepoints of the optimum partition of the interval as identified by the bayesian blocks algorithm.</p>
<dl class="section note"><dt>Note</dt><dd>It is the caller's responsibility to delete the returned vector.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>- On <b>success:</b> Pointer to a std::vector&lt;Double_t&gt; containing the changepoints of the optimum partition of the interval as identified by the bayesian blocks algorithm. </dd>
<dd>
- On <b>failure:</b> 0. </dd></dl>

</div>
</div>
<a class="anchor" id="a4cb297c240989be96626a89b9fd6ec7c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Temporal::BayesianBlocks::OptimumPartition </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Method which constructs the optimum partition of an interval. </p>
<p>This method finds the optimum partition of the current interval.</p>
<p>Method: The basic procedure is controlled by two nested loops over the vector of cell widths (fCellWidths).</p><ol type="1">
<li>The outer loop controls the number of cells in the <b>current</b> interval. This <b>current</b> interval is a sub-interval of the full interval under test, and is incremented by one cell on every execution of the loop until the <b>current</b> interval equals the full interval under test.<ol type="a">
<li>The inner loop loops over all cell positions from the first cell to the highest cell in the <b>current</b> interval.</li>
<li>At each position the the fitness is computed as the fitness of the optimum partition of the previous cells in the interval (not including the current cell), added to the fitness of a single block extending from the current position to the end of the <b>current</b> interval (See <a class="el" href="class_temporal_1_1_bayesian_blocks.html#a883de9dc93776d348a50e611ec300eb2" title="Method calculates the fitness of a given interval. ">CalcFitness()</a>). This fitness is stored in a temporary vector.</li>
</ol>
</li>
<li>Back in the outer loop, the maximum value in the temporary array is added to the array fBest and its position in the temporary array (which corresponds directly to a position in the array of binwidths) is added to fChangePoints. </li>
</ol>

</div>
</div>
<a class="anchor" id="acd4086b8c86998b5b7815920e76bb4f8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Temporal::BayesianBlocks::Reset </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Method to reset clear all of the persistent vectors and deques. </p>
<p>Method resets and clears all the persistent vectors and deques except fEventTimes. </p>

</div>
</div>
<a class="anchor" id="aadb26f9efc6b79e6397c926fda3dbca5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Temporal::BayesianBlocks::SetEventTimes </td>
          <td>(</td>
          <td class="paramtype">Double_t *&#160;</td>
          <td class="paramname"><em>eventTimes</em> = <code>0</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Method to set the array of event times. </p>
<p>This method sets the array of event times. fNumEvents must be specified (preferably correctly!) either on instantiation or using <a class="el" href="class_temporal_1_1_bayesian_blocks.html#a9e5a4620c8e15fd41ad7c87dd2cc7240" title="Method to set the number of events in the DataSet. ">SetNumEvents()</a> to a positive integer or this method will warn you that you have made an error and return with no other effect.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">eventTimes</td><td>- A pointer to the first element in the array of event times. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a9e5a4620c8e15fd41ad7c87dd2cc7240"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Temporal::BayesianBlocks::SetNumEvents </td>
          <td>(</td>
          <td class="paramtype">Int_t&#160;</td>
          <td class="paramname"><em>numEvents</em> = <code>0</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Method to set the number of events in the DataSet. </p>
<p>This method sets the the number of events fNumEvents. The number of events specified must be an integer greater than zero.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">numEvents</td><td>- The number of events in the DataSet. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a4303f0cbacbab9131db9485f083a45d0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;Double_t&gt;* Temporal::BayesianBlocks::fBest</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A vector containing the value of the optimal "Fitness" of the previous interval for all positions. </p>

</div>
</div>
<a class="anchor" id="aa52f4f945f05efd9dd9db6bcb77bffab"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;Double_t&gt;* Temporal::BayesianBlocks::fBlockEdges</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A vector the edges of the blocks of the optimum partition in seconds since J2000. </p>

</div>
</div>
<a class="anchor" id="a7775a6c55a14de1d699a00827f88cc65"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;Double_t&gt;* Temporal::BayesianBlocks::fCellWidths</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A vector of the widths of cells formed around the individual events. </p>

</div>
</div>
<a class="anchor" id="a3947b6d02cf8fc3f98cbae59326dba75"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::deque&lt;Int_t&gt;* Temporal::BayesianBlocks::fChangePoints</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector of the changepoints (in terms of cell number) identified by the Bayesian Blocks algorithm. </p>

</div>
</div>
<a class="anchor" id="a850f2c3cfe5dbe6845e39fbfb450ddcd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Double_t Temporal::BayesianBlocks::fEndTime</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The end time of the interval in seconds since J2000. </p>

</div>
</div>
<a class="anchor" id="a00dfabcba71342784fe1b43c2d5959ac"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;Double_t&gt;* Temporal::BayesianBlocks::fEventTimes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A vector formed from the input array of event times. </p>

</div>
</div>
<a class="anchor" id="a80492db7d18c3c60c846b619561788d0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Double_t Temporal::BayesianBlocks::fGamma</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The value of <img class="formulaInl" alt="$\gamma$" src="form_4.png"/> used to penalise the addition of extra blocks. </p>

</div>
</div>
<a class="anchor" id="a823e53c7e269032c4ac6342f834b0c28"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;Int_t&gt;* Temporal::BayesianBlocks::fLast</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A vector containing the index of the last changepoint for all positions. </p>

</div>
</div>
<a class="anchor" id="a6cdf3d64615a960a4ee8e8d92e71c62c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Int_t Temporal::BayesianBlocks::fNumEvents</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The number of events in the Dataset. </p>

</div>
</div>
<a class="anchor" id="a63d24c37ad58710297109c70bf1c192d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Double_t Temporal::BayesianBlocks::fStartTime</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The start time of the interval in seconds since J2000. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/<a class="el" href="_bayesian_blocks_8hh_source.html">BayesianBlocks.hh</a></li>
<li>src/<a class="el" href="_bayesian_blocks_8_c.html">BayesianBlocks.C</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Oct 22 2015 16:17:01 for Bayesian Blocks by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
